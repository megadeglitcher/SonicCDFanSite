<html lang="en">
<head>
    <link rel="icon" href="icon.png" type="image/png">
    <title>testing cd buttons</title>
    <style>
        @import url("sonic_cd_menu_font/stylesheet.css");

        /* Remove default body margin/padding */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow-x: hidden; /* Disable horizontal scrolling */
            overflow-y: auto; /* Allow vertical scrolling */
        }

        /* Hide scrollbars */
        ::-webkit-scrollbar {
            display: none;
        }

        /* Add background image to the body */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;
            background: url('images/bg.png') center center / cover fixed no-repeat; /* Background setup */
            font-family: "sonic cd menu font", sans-serif;
            text-shadow: 
                6px 0px 0px rgba(64, 64, 64),
                6px 5px 0px rgba(64, 64, 64),
                0px 5px 0px rgba(64, 64, 64);
            user-select: none;
        }

        h1 {
            user-select: none;
            margin-left: 15px;
            text-align: center;
            top: 44.1%;
            position: absolute;
            color: white;
            left: 36%;
            font-size: 1.7vw;
            color: #e0e0e0;
            letter-spacing: 10px;
            transform: scale(1);
        }
        
        h1.clicked {
            user-select: none;
            margin-left: 15px;
            text-align: center;
            top: 44.1%;
            position: absolute;
            color: white;
            left: 36%;
            font-size: 1.7vw;
            color: #e0e000;
            letter-spacing: 10px;
            transform: scale(0.95);
        }
        
        #beans-btn.clicked {
            transform: scale(0.95);
        }
        
        .non-interactive-container {
            pointer-events: none; /* Makes all child elements non-interactive */
        }
    </style>
</head>
<body>
    <div>
        <div id="exampleButton">
            <img src="button.png" style="width: 700px;" id="beans-btn" draggable="false"> <!-- Prevent dragging -->
            <div class="non-interactive-container">
                <h1 id="beans-text">TIME ATTACK</h1>
            </div>
        </div>
    </div>
	<script>
		const exampleButton = document.getElementById("beans-btn");
		const exampleText = document.getElementById("beans-text");
		const exampleButtonContainer = document.querySelector("div");
		const soundEffect = new Audio('sounds/MenuButton.wav');
		const soundEffectEnter = new Audio('sounds/Select.wav');

		let isFlashing = false;
		let intervalId = null;
		let isNavigating = false; // Flag to prevent duplicate actions
		let isPressed = false; // Flag to keep track if the button has been pressed

		exampleButtonContainer.addEventListener("mouseover", () => {
			if (!isFlashing && !isNavigating && !isPressed) { // Ensure the button isn't already pressed
				soundEffect.currentTime = 0;
				soundEffect.volume = 0.7;
				soundEffect.play();
				exampleButton.style.filter = "brightness(1.2)";
				exampleText.style.color = "#FFFF00";
			}
		});

		exampleButtonContainer.addEventListener("mouseout", () => {
			if (!isFlashing && !isNavigating) { // Check if not navigating
				exampleButton.style.filter = "none";
				exampleText.style.color = "#e0e0e0";
				if (!isFlashing) {
					exampleButton.style.transform = "scale(1)";
					exampleText.style.transform = "scale(1)";
				}
			}
		});

		exampleButtonContainer.addEventListener("mousedown", () => {
			if (!isNavigating && !isPressed) { // Check if the button isn't already pressed
				isPressed = true; // Mark the button as pressed
				exampleText.classList.add("clicked");
				exampleButton.classList.add("clicked");
				exampleButton.style.transform = "scale(0.95)";
				exampleText.style.transform = "scale(0.95)";
			}
		});

		exampleButtonContainer.addEventListener("mouseup", () => {
			if (!isNavigating && (soundEffectEnter.paused || soundEffectEnter.ended)) {
				isNavigating = true; // Set the flag to true to indicate navigation is in progress

				exampleText.classList.remove("clicked");
				exampleButton.classList.remove("clicked");

				// Play the sound effect only if not already playing
				soundEffectEnter.currentTime = 0; // Reset to the beginning of the sound
				soundEffectEnter.volume = 0.7;
				soundEffectEnter.play();

				// Flash animation logic
				isFlashing = true;
				let isVisible = true;
				intervalId = setInterval(() => {
					if (isVisible) {
						exampleText.style.opacity = '0';
					} else {
						exampleText.style.opacity = '1';
					}
					isVisible = !isVisible;
				}, 50);

				// Stop the flashing and navigate after the sound has played
				soundEffectEnter.onended = () => {
					clearInterval(intervalId);
					exampleText.style.opacity = '1'; // Ensure text is fully visible at the end
					isFlashing = false; // Reset flashing state
					isNavigating = false; // Reset navigation flag

					// Navigate to the URL
					window.location.href = "forums.html";
				};
			} else if (isNavigating) {
				console.log("Navigation in progress. Action not allowed.");
			} else {
				console.log("The sound is already playing. Action not allowed.");
			}
		});

		exampleButtonContainer.addEventListener("mouseleave", () => {
			if (isFlashing && !isNavigating) { // Ensure it's not during navigation
				exampleButton.style.transform = "scale(0.95)";
				exampleText.style.transform = "scale(0.95)";
				soundEffectEnter.currentTime = 0; // Reset to the beginning of the sound
				soundEffectEnter.volume = 0.1; // Set the volume to a reasonable level
				soundEffectEnter.play();
			}
		});

		// If the button has been pressed, maintain the scale of 0.95
		if (isPressed) {
			exampleButton.style.transform = "scale(0.95)";
			exampleText.style.transform = "scale(0.95)";
		}

		exampleText.style.pointerEvents = "none";
	</script>
</body>
</html>
